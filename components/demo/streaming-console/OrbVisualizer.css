.orb-visualizer {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  border-radius: 50%;
  pointer-events: none;
}

/* --- Input Visualizer - User Speaking --- */
.input-visualizer {
  position: absolute;
  inset: 0;
  mix-blend-mode: screen;
  opacity: 0.9;
}

/* Add a soft inner glow that responds to user voice */
.input-visualizer::before {
  content: '';
  position: absolute;
  inset: 0;
  border-radius: 50%;
  box-shadow: inset 0 0 40px 10px rgba(0, 220, 255, 0.7);
  opacity: var(--input-volume);
  transform: scale(calc(1 + var(--input-volume) * 0.05));
  transition: all 300ms ease-out;
}

.input-ring {
  position: absolute;
  top: 50%;
  left: 50%;
  width: 100%;
  height: 100%;
  border-radius: 50%;
  /* Replaced border with a softer box-shadow for a glow effect */
  box-shadow: 0 0 15px 2px rgba(0, 220, 255, 0.7);
  transform: translate(-50%, -50%) scale(calc(0.95 + var(--input-volume) * 0.3)); /* Increased reactivity */
  opacity: calc(var(--input-volume) * var(--input-volume) * 1.2);
}

/* Staggered and more organic transitions */
.input-ring:nth-child(1) {
  transition:
    transform 300ms cubic-bezier(0.2, 1, 0.3, 1),
    opacity 500ms ease-out;
}

.input-ring:nth-child(2) {
  transition:
    transform 350ms cubic-bezier(0.2, 1, 0.3, 1),
    opacity 500ms ease-out;
  transition-delay: 80ms;
}

.input-ring:nth-child(3) {
  transition:
    transform 400ms cubic-bezier(0.2, 1, 0.3, 1),
    opacity 500ms ease-out;
  transition-delay: 160ms;
}

/* --- Playback Visualizer - AI Speaking (Cloudy Nebula) --- */
.playback-visualizer {
  position: absolute;
  inset: 0;
  overflow: hidden;
  border-radius: 50%;
  /* Overall intensity scales with playback volume */
  transform: scale(calc(0.9 + var(--playback-volume) * 0.2));
  opacity: calc(var(--playback-volume) * 1.2); /* Slightly brighter */
  transition:
    transform 400ms ease-out,
    opacity 400ms ease-out;
  /* Add perspective and preserve 3D for children */
  perspective: 800px;
  transform-style: preserve-3d;
}

/* Slower, more majestic keyframes for nebula effect */
@keyframes nebula-swirl {
  0% { transform: rotateX(0deg) rotateY(0deg) rotateZ(0deg) scale(1.2); }
  50% { transform: rotateX(180deg) rotateY(45deg) rotateZ(90deg) scale(1.5); }
  100% { transform: rotateX(360deg) rotateY(0deg) rotateZ(360deg) scale(1.2); }
}

@keyframes nebula-swirl-reverse {
  0% { transform: rotateX(0deg) rotateY(0deg) rotateZ(0deg) scale(1.4); }
  50% { transform: rotateX(-90deg) rotateY(-180deg) rotateZ(-45deg) scale(1.1); }
  100% { transform: rotateX(-360deg) rotateY(-360deg) rotateZ(-360deg) scale(1.4); }
}

.aurora-layer {
  position: absolute;
  width: 200%;
  height: 200%;
  top: -50%;
  left: -50%;
  mix-blend-mode: soft-light; /* Softer blend mode for cloudy effect */
  filter: blur(40px); /* Heavy blur for soft, gaseous texture */
}

/* Lime-green nebula color palette */
.aurora-layer.aurora1 {
  background:
    radial-gradient(ellipse at 40% 60%, hsla(120, 100%, 70%, 0.7) 0%, transparent 50%),
    radial-gradient(ellipse at 70% 30%, hsla(160, 80%, 60%, 0.5) 0%, transparent 40%);
  animation: nebula-swirl 20s ease-in-out infinite alternate;
}

.aurora-layer.aurora2 {
  background:
    radial-gradient(ellipse at 60% 40%, hsla(100, 100%, 80%, 0.6) 0%, transparent 60%),
    linear-gradient(135deg, hsla(130, 90%, 50%, 0.4) 0%, transparent 70%);
  animation: nebula-swirl-reverse 25s ease-in-out infinite alternate;
}

.aurora-layer.aurora3 {
  background:
    radial-gradient(ellipse at 50% 50%, hsla(90, 100%, 75%, 0.5) 0%, transparent 50%),
    radial-gradient(ellipse at 20% 20%, hsla(140, 100%, 60%, 0.6) 0%, transparent 45%);
  animation: nebula-swirl 30s ease-in-out infinite reverse alternate;
}