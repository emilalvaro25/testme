.orb-visualizer {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  border-radius: 50%;
  pointer-events: none;
}

/* --- Input Visualizer - User Speaking --- */
.input-visualizer {
  position: absolute;
  inset: 0;
  mix-blend-mode: screen;
  opacity: 0.9;
}

/* Add a soft inner glow that responds to user voice */
.input-visualizer::before {
  content: '';
  position: absolute;
  inset: 0;
  border-radius: 50%;
  box-shadow: inset 0 0 40px 10px rgba(0, 220, 255, 0.7);
  opacity: var(--input-volume);
  transform: scale(calc(1 + var(--input-volume) * 0.05));
  transition: all 300ms ease-out;
}

.input-ring {
  position: absolute;
  top: 50%;
  left: 50%;
  width: 100%;
  height: 100%;
  border-radius: 50%;
  /* Replaced border with a softer box-shadow for a glow effect */
  box-shadow: 0 0 15px 2px rgba(0, 220, 255, 0.7);
  transform: translate(-50%, -50%) scale(calc(0.95 + var(--input-volume) * 0.3)); /* Increased reactivity */
  opacity: calc(var(--input-volume) * var(--input-volume) * 1.2);
}

/* Staggered and more organic transitions */
.input-ring:nth-child(1) {
  transition:
    transform 300ms cubic-bezier(0.2, 1, 0.3, 1),
    opacity 500ms ease-out;
}

.input-ring:nth-child(2) {
  transition:
    transform 350ms cubic-bezier(0.2, 1, 0.3, 1),
    opacity 500ms ease-out;
  transition-delay: 80ms;
}

.input-ring:nth-child(3) {
  transition:
    transform 400ms cubic-bezier(0.2, 1, 0.3, 1),
    opacity 500ms ease-out;
  transition-delay: 160ms;
}

/* --- Playback Visualizer - AI Speaking --- */
.playback-visualizer {
  position: absolute;
  inset: 0;
  overflow: hidden;
  border-radius: 50%;
  /* Overall intensity scales with playback volume */
  transform: scale(calc(0.8 + var(--playback-volume) * 0.4));
  opacity: calc(var(--playback-volume) * 1.1); /* Slightly brighter */
  transition:
    transform 400ms ease-out,
    opacity 400ms ease-out;
  /* Add perspective and preserve 3D for children */
  perspective: 800px;
  transform-style: preserve-3d;
}

/* Enhanced keyframes for more fluid, less predictable movement */
@keyframes swirl3d {
  0% { transform: rotateX(0deg) rotateY(0deg) rotateZ(0deg) scale(1.2); opacity: 0.8; }
  33% { transform: rotateX(120deg) rotateY(45deg) rotateZ(180deg) scale(1.6); opacity: 1; }
  66% { transform: rotateX(240deg) rotateY(270deg) rotateZ(270deg) scale(1.1); opacity: 0.7; }
  100% { transform: rotateX(360deg) rotateY(360deg) rotateZ(360deg) scale(1.2); opacity: 0.8; }
}

@keyframes swirl-reverse3d {
  0% { transform: rotateX(0deg) rotateY(0deg) rotateZ(0deg) scale(1.4); opacity: 0.7; }
  33% { transform: rotateX(-45deg) rotateY(-180deg) rotateZ(-90deg) scale(1.0); opacity: 1; }
  66% { transform: rotateX(-270deg) rotateY(-270deg) rotateZ(-180deg) scale(1.5); opacity: 0.8; }
  100% { transform: rotateX(-360deg) rotateY(-360deg) rotateZ(-360deg) scale(1.4); opacity: 0.7; }
}

.aurora-layer {
  position: absolute;
  width: 200%;
  height: 200%;
  top: -50%;
  left: -50%;
  mix-blend-mode: color-dodge; /* A more ethereal blend mode */
}

/* More complex, nebula-like gradients for a richer cosmic feel */
.aurora-layer.aurora1 {
  background:
    radial-gradient(ellipse at 40% 60%, hsla(275, 100%, 70%, 0.7) 0%, transparent 60%),
    radial-gradient(ellipse at 70% 30%, hsla(220, 100%, 70%, 0.5) 0%, transparent 50%);
  animation: swirl3d 12s ease-in-out infinite alternate;
}

.aurora-layer.aurora2 {
  background:
    radial-gradient(ellipse at 60% 40%, hsla(210, 100%, 80%, 0.6) 0%, transparent 70%),
    radial-gradient(ellipse at 30% 80%, hsla(320, 100%, 75%, 0.4) 0%, transparent 60%);
  animation: swirl-reverse3d 15s ease-in-out infinite alternate;
}

.aurora-layer.aurora3 {
  background:
    radial-gradient(ellipse at 50% 50%, hsla(330, 100%, 75%, 0.5) 0%, transparent 60%),
    radial-gradient(ellipse at 20% 20%, hsla(260, 100%, 70%, 0.6) 0%, transparent 55%);
  animation: swirl3d 18s ease-in-out infinite reverse alternate;
}
